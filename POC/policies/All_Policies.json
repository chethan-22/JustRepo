{
    "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
    "contentVersion": "1.0.0.0",
    "resources": [
        {
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2019-09-01",
            "name": "All network ports should be restricted on network security groups associated to your virtual machine",
            "properties": {
                "displayName": "All network ports should be restricted on network security groups associated to your virtual machine",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/9daedab3-fb2d-461e-b861-71790eead4f6",
                "description": "Azure Security Center has identified some of your network security groups' inbound rules to be too permissive. Inbound rules should not allow access from 'Any' or 'Internet' ranges. This can potentially enable attackers to target your resources.",
                "metadata": {
                    "version": "3.0.0",
                    "category": "Security Center"
                },
                "parameters": {
                    "effect": {
                        "type": "string",
                        "metadata": {
                            "description": "Enable or disable the execution of the policy",
                            "displayName": "Effect"
                        },
                        "allowedValues": [
                            "AuditIfNotExists",
                            "Disabled"
                        ],
                        "defaultValue": "AuditIfNotExists"
                    }
                }
            }
        },
        {
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2019-09-01",
            "name": "[Deprecated]: Microsoft Defender for Storage (Classic) should be enabled",
            "properties": {
                "displayName": "[Deprecated]: Microsoft Defender for Storage (Classic) should be enabled",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/308fbb08-4ab8-4e67-9b29-592e93fb94fa",
                "description": "This policy enables you to specify a set of virtual machine size SKUs that your organization can deploy.",
                "metadata": {
                    "version": "1.1.0-deprecated",
                    "category": "Security Center"
                },
                "parameters": {
                    "effect": {
                        "type": "string",
                        "metadata": {
                            "description": "Enable or disable the execution of the policy",
                            "displayName": "Effect"
                        },
                        "allowedValues": [
                            "AuditIfNotExists",
                            "Disabled"
                          ],
                          "defaultValue": "Disabled"
                    }
                }
            }
        },
        {
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2019-09-01",
            "name": "Allowed locations for resource groups",
            "properties": {
                "displayName": "Allowed locations for resource groups",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/e765b5de-1225-4ba3-bd56-1ac6695af988",
                "description": "This policy enables you to restrict the locations your organization can create resource groups in. Use to enforce your geo-compliance requirements.",
                "metadata": {
                    "version": "1.0.0",
                    "category": "General"
                },
                "parameters": {
                    "listOfAllowedLocations": {
                        "type": "array",
                        "metadata": {
                            "description": "The list of locations that resource groups can be created in.",
                            "strongType": "location",
                            "displayName": "Allowed locations"
                        }
                    }
                }
            }
        },
        {
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2019-09-01",
            "name": "Allowed locations",
            "properties": {
                "displayName": "Allowed locations",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/e56962a6-4747-49cd-b67b-bf8b01975c4c",
                "description": "This policy enables you to restrict the locations your organization can specify when deploying resources. Use to enforce your geo-compliance requirements. Excludes resource groups, Microsoft.AzureActiveDirectory/b2cDirectories, and resources that use the 'global' region.",
                "metadata": {
                    "version": "1.0.0",
                    "category": "General"
                },
                "parameters": {
                    "listOfAllowedLocations": {
                        "type": "array",
                        "metadata": {
                            "description": "The list of locations that can be specified when deploying resources.",
                            "displayName": "Allowed locations"
                        }
                    }
                }
            }
        },
        {
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2019-09-01",
            "name": "Storage accounts should be limited by allowed SKUs",
            "properties": {
                "displayName": "Storage accounts should be limited by allowed SKUs",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/7433c107-6db4-4ad1-b57a-a76dce0154a1",
                "description": "Restrict the set of storage account SKUs that your organization can deploy.",
                "metadata": {
                    "version": "1.1.0",
                    "category": "Storage"
                },
                "parameters": {
                    "effect": {
                        "type": "string",
                        "metadata": {
                            "description": "Enable or disable the execution of the audit policy",
                            "displayName": "Effect"
                        },
                        "allowedValues": [
                            "Audit",
                            "Deny",
                            "Disabled" 
                        ],
                        "defaultValue": "Deny"
                    }
                }
            }
        },
        {
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2019-09-01",
            "name": "An Azure Active Directory administrator should be provisioned for SQL servers",
            "properties": {
                "displayName": "An Azure Active Directory administrator should be provisioned for SQL servers",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/1f314764-cb73-4fc9-b863-8eca98ac36e9",
                "description": "Audit provisioning of an Azure Active Directory administrator for your SQL server to enable Azure AD authentication. Azure AD authentication enables simplified permission management and centralized identity management of database users and other Microsoft services",
                "metadata": {
                    "version": "1.0.0",
                    "category": "SQL"
                },
                "parameters": {
                    "effect": {
                        "type": "string",
                        "metadata": {
                            "description": "Enable or disable the execution of the policy",
                            "displayName": "Effect"
                        },
                        "allowedValues": [
                            "AuditIfNotExists",
                            "Disabled"
                          ],
                          "defaultValue": "AuditIfNotExists"
                    }
                }
            }
        },
        {
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2019-09-01",
            "name": "Authorized IP ranges should be defined on Kubernetes Services",
            "properties": {
                "displayName": "Authorized IP ranges should be defined on Kubernetes Services",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/0e246bcf-5f6f-4f87-bc6f-775d4712c7ea",
                "description": "Restrict access to the Kubernetes Service Management API by granting API access only to IP addresses in specific ranges. It is recommended to limit access to authorized IP ranges to ensure that only applications from allowed networks can access the cluster.",
                "metadata": {
                    "version": "2.0.1",
                    "category": "Security Center"
                },
                "parameters": {
                    "effect": {
                        "type": "string",
                        "metadata": {
                            "description": "Enable or disable the execution of the policy",
                            "displayName": "Effect"
                        },
                        "allowedValues": [
                            "Audit",
                            "Disabled"
                          ],
                          "defaultValue": "Audit"
                    }
                }
            }
        },
        {
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2019-09-01",
            "name": "Azure DDoS Protection should be enabled",
            "properties": {
                "displayName": "Azure DDoS Protection should be enabled",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/a7aca53f-2ed4-4466-a25e-0b45ade68efd",
                "description": "DDoS protection should be enabled for all virtual networks with a subnet that is part of an application gateway with a public IP.",
                "metadata": {
                    "version": "3.0.1",
                    "category": "Security Center"
                },
                "parameters": {
                    "effect": {
                        "type": "string",
                        "metadata": {
                            "description": "Enable or disable the execution of the policy",
                            "displayName": "Effect"
                        },
                        "allowedValues": [
                            "AuditIfNotExists",
                            "Disabled"
                          ],
                          "defaultValue": "AuditIfNotExists"
                    }
                }
            }
        },
        {
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2019-09-01",
            "name": "Deploy - Configure Dependency agent to be enabled on Windows virtual machines",
            "properties": {
                "displayName": "Deploy - Configure Dependency agent to be enabled on Windows virtual machines",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/1c210e94-a481-4beb-95fa-1571b434fb04",
                "description": "Deploy Dependency agent for Windows virtual machines if the virtual machine image is in the list defined and the agent is not installed.",
                "metadata": {
                    "version": "3.1.0",
                    "category": "Monitoring"
                },
                "parameters": {
                    "listOfImageIdToInclude": {
                        "type": "array",
                        "metadata": {
                            "description": "Example value: '/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'",
                            "displayName": "Optional: List of virtual machine images that have supported Windows OS to add to scope"
                        },
                        "defaultValue": []
                    },
                    "effect": {
                        "type": "string",
                        "metadata": {
                          "displayName": "Effect",
                          "description": "Enable or disable the execution of the policy"
                        },
                        "allowedValues": [
                          "DeployIfNotExists",
                          "Disabled"
                        ],
                        "defaultValue": "DeployIfNotExists"
                      }
                }
            }
        },
        {
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2019-09-01",
            "name": "Deploy Advanced Data Security on SQL servers",
            "properties": {
                "displayName": "Deploy Advanced Data Security on SQL servers",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/6134c3db-786f-471e-87bc-8f479dc890f6",
                "description": "This policy enables Advanced Data Security on SQL Servers. This includes turning on Threat Detection and Vulnerability Assessment. It will automatically create a storage account in the same region and resource group as the SQL server to store scan results, with a 'sqlva' prefix.",
                "metadata": {
                    "version": "1.3.0",
                    "category": "SQL"
                },
                "parameters": {}
            }
        },
        {
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2019-09-01",
            "name": "Deploy Defender for Storage (Classic) on storage accounts",
            "properties": {
                "displayName": "Deploy Defender for Storage (Classic) on storage accounts",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/361c2074-3595-4e5d-8cab-4f21dffc835c",
                "description": "This policy enables Defender for Storage (Classic) on storage accounts.",
                "metadata": {
                    "version": "1.0.1",
                    "category": "Storage"
                },
                "parameters": {
                    "effect": {
                        "type": "string",
                        "metadata": {
                            "description": "Enable or disable the execution of the policy",
                            "displayName": "Effect"
                        },
                        "allowedValues": [
                            "DeployIfNotExists",
                            "Disabled"
                        ],
                        "defaultValue": "DeployIfNotExists"
                    }
                }
            }
        },
        {
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2019-09-01",
            "name": "Configure SQL servers to have auditing enabled",
            "properties": {
                "displayName": "Configure SQL servers to have auditing enabled",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/f4c68484-132f-41f9-9b6d-3e4b1cb55036",
                "description": "To ensure the operations performed against your SQL assets are captured, SQL servers should have auditing enabled. This is sometimes required for compliance with regulatory standards.",
                "metadata": {
                    "version": "3.0.0",
                    "category": "SQL"
                },
                "parameters": {
                  "effect": {
                    "type": "string",
                    "metadata": {
                      "displayName": "Effect",
                      "description": "Enable or disable the execution of the policy"
                    },
                    "allowedValues": [
                      "DeployIfNotExists",
                      "Disabled"
                    ],
                    "defaultValue": "DeployIfNotExists"
                  },
                  "retentionDays": {
                    "type": "string",
                    "metadata": {
                      "description": "The value in days of the retention period (0 indicates unlimited retention)",
                      "displayName": "Retention days (optional, 180 days if unspecified)"
                    },
                    "defaultValue": "180"
                  },
                  "storageAccountsResourceGroup": {
                    "type": "string",
                    "metadata": {
                      "displayName": "Resource group name for storage accounts",
                      "description": "Auditing writes database events to an audit log in your Azure Storage account (a storage account will be created in each region where a SQL Server is created that will be shared by all servers in that region). Important - for proper operation of Auditing do not delete or rename the resource group or the storage accounts.",
                      "strongType": "existingResourceGroups"
                    }
                  }
                }
            }
        },
        {
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2019-09-01",
            "name": "Deploy default Microsoft IaaSAntimalware extension for Windows Server",
            "properties": {
                "displayName": "Deploy default Microsoft IaaSAntimalware extension for Windows Server",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/2835b622-407b-4114-9198-6f7064cbe0dc",
                "description": "This policy deploys a Microsoft IaaSAntimalware extension with a default configuration when a VM is not configured with the antimalware extension.",
                "metadata": {
                    "version": "1.1.0",
                    "category": "Compute"
                },
                "parameters": {}
            }
        },
        {
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2019-09-01",
            "name": "Deploy Dependency agent for Linux virtual machines",
            "properties": {
                "displayName": "Deploy Dependency agent for Linux virtual machines",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/4da21710-ce6f-4e06-8cdb-5cc4c93ffbee",
                "description": "Deploy Dependency agent for Linux virtual machines if the VM Image (OS) is in the list defined and the agent is not installed.",
                "metadata": {
                    "version": "5.0.0",
                    "category": "Monitoring"
                },
                "parameters": {
                    "listOfImageIdToInclude": {
                        "type": "array",
                        "metadata": {
                            "description": "Example value: '/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'",
                            "displayName": "Optional: List of VM images that have supported Linux OS to add to scope"
                        },
                        "defaultValue": []
                    }
                }
            }
        },
        {
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2019-09-01",
            "name": "Deploy Log Analytics extension for Linux VMs. See deprecation notice below",
            "properties": {
                "displayName": "Deploy Log Analytics extension for Linux VMs. See deprecation notice below",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/053d3325-282c-4e5c-b944-24faffd30d77",
                "description": "Deploy Log Analytics extension for Linux VMs if the VM Image (OS) is in the list defined and the extension is not installed. Deprecation notice: The Log Analytics agent is on a deprecation path and won't be supported after August 31, 2024. You must migrate to the replacement 'Azure Monitor agent' prior to that date",
                "metadata": {
                    "version": "3.0.0",
                    "category": "Monitoring"
                },
                "parameters": {
                    "logAnalytics": {
                        "type": "string",
                        "metadata": {
                            "description": "Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.",
                            "displayName": "Log Analytics workspace",
                            "strongType": "omsWorkspace",
                            "assignPermissions": true
                        }
                    },
                    "listOfImageIdToInclude": {
                        "type": "array",
                        "metadata": {
                          "displayName": "Optional: List of VM images that have supported Linux OS to add to scope",
                          "description": "Example value: '/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'"
                        },
                        "defaultValue": []
                      }
                }
            }
        },
        {
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2019-09-01",
            "name": "Deploy - Configure Log Analytics extension to be enabled on Windows virtual machines",
            "properties": {
                "displayName": "Deploy - Configure Log Analytics extension to be enabled on Windows virtual machines",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/0868462e-646c-4fe3-9ced-a733534b6a2c",
                "description": "Deploy Log Analytics extension for Windows virtual machines if the virtual machine image is in the list defined and the extension is not installed. Deprecation notice: The Log Analytics agent is on a deprecation path and won't be supported after August 31, 2024. You must migrate to the replacement 'Azure Monitor agent' prior to that date.",
                "metadata": {
                    "version": "3.1.0",
                    "category": "Monitoring"
                },
                "parameters": {
                    "logAnalytics": {
                        "type": "string",
                        "metadata": {
                            "description": "Log Analytics workspace is used to receive performance data. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.",
                            "displayName": "Log Analytics workspace",
                            "strongType": "omsWorkspace",
                            "assignPermissions": true
                        }
                    },
                    "listOfImageIdToInclude": {
                        "type": "array",
                        "metadata": {
                          "displayName": "Optional: List of virtual machine images that have supported Windows OS to add to scope",
                          "description": "Example values: '/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'"
                      },
                        "defaultValue": []
                    },
                    "effect": {
                        "type": "string",
                        "metadata": {
                          "displayName": "Effect",
                          "description": "Enable or disable the execution of the policy"
                        },
                        "allowedValues": [
                          "DeployIfNotExists",
                          "Disabled"
                        ],
                        "defaultValue": "DeployIfNotExists"
                      }
                }
            }
        },
        {
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2019-09-01",
            "name": "Deploy network watcher when virtual networks are created",
            "properties": {
                "displayName": "Deploy network watcher when virtual networks are created",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/a9b99dd8-06c5-4317-8629-9d86a3c6e7d9",
                "description": "This policy creates a network watcher resource in regions with virtual networks. You need to ensure existence of a resource group named networkWatcherRG, which will be used to deploy network watcher instances.",
                "metadata": {
                    "version": "1.0.0",
                    "category": "Network"
                },
                "parameters": {}
            }
        },
        {
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2019-09-01",
            "name": "Deploy SQL DB transparent data encryption",
            "properties": {
                "displayName": "Deploy SQL DB transparent data encryption",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/86a912f6-9a06-4e26-b447-11b16ba8659f",
                "description": "Enables transparent data encryption on SQL databases",
                "metadata": {
                    "version": "2.2.0",
                    "category": "SQL"
                },
                "parameters": {
                    "effect": {
                        "type": "string",
                        "metadata": {
                            "description": "Enable or disable the execution of the policy",
                            "displayName": "Effect"
                        },
                        "allowedValues": [
                            "DeployIfNotExists",
                            "Disabled"
                          ],
                          "defaultValue": "DeployIfNotExists"
                    }
                }
            }
        },
        {
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2019-09-01",
            "name": "Configure Azure Defender to be enabled on SQL servers",
            "properties": {
                "displayName": "Configure Azure Defender to be enabled on SQL servers",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/36d49e87-48c4-4f2e-beed-ba4ed02b71f5",
                "description": "Enable Azure Defender on your Azure SQL Servers to detect anomalous activities indicating unusual and potentially harmful attempts to access or exploit databases.",
                "metadata": {
                    "version": "2.1.0",
                    "category": "SQL"
                },
                "parameters": {}
            }
        },
        {
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2019-09-01",
            "name": "Resource logs in Key Vault should be enabled",
            "properties": {
                "displayName": "Resource logs in Key Vault should be enabled",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/cf820ca0-f99e-4f3e-84fb-66e913812d21",
                "description": "Audit enabling of resource logs. This enables you to recreate activity trails to use for investigation purposes when a security incident occurs or when your network is compromised",
                "metadata": {
                    "version": "5.0.0",
                    "category": "Key Vault"
                },
                "parameters": {
                    "effect": {
                        "type": "string",
                        "metadata": {
                            "description": "Enable or disable the execution of the policy",
                            "displayName": "Effect"
                        },
                        "allowedValues": [
                            "AuditIfNotExists",
                            "Disabled"
                          ],
                          "defaultValue": "AuditIfNotExists"
                    }
                }
            }
        },
        {
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2019-09-01",
            "name": "Virtual machines should encrypt temp disks, caches, and data flows between Compute and Storage resources",
            "properties": {
                "displayName": "Virtual machines should encrypt temp disks, caches, and data flows between Compute and Storage resources",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/0961003e-5a0a-4549-abde-af6a37f2724d",
                "description": "By default, a virtual machine's OS and data disks are encrypted-at-rest using platform-managed keys. Temp disks, data caches and data flowing between compute and storage aren't encrypted. Disregard this recommendation if: 1. using encryption-at-host, or 2. server-side encryption on Managed Disks meets your security requirements. Learn more in: Server-side encryption of Azure Disk Storage: https://aka.ms/disksse, Different disk encryption offerings: https://aka.ms/diskencryptioncomparison",
                "metadata": {
                    "version": "2.0.3",
                    "category": "Security Center"
                },
                "parameters": {
                    "effect": {
                        "type": "string",
                        "metadata": {
                            "description": "Enable or disable the execution of the policy",
                            "displayName": "Effect"
                        },
                        "allowedValues": [
                            "AuditIfNotExists",
                            "Disabled"
                        ],
                        "defaultValue": "AuditIfNotExists"
                    }
                }
            }
        },
        {
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2019-09-01",
            "name": "Enable Microsoft Defender for Cloud on your subscription",
            "properties": {
                "displayName": "Enable Microsoft Defender for Cloud on your subscription",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/ac076320-ddcf-4066-b451-6154267e8ad2",
                "description": "Identifies existing subscriptions that aren't monitored by Microsoft Defender for Cloud and protects them with Defender for Cloud's free features.\r\nSubscriptions already monitored will be considered compliant.\r\nTo register newly created subscriptions, open the compliance tab, select the relevant non-compliant assignment, and create a remediation task.",
                "metadata": {
                    "version": "1.0.1",
                    "category": "Security Center"
                },
                "parameters": {}
            }
        },
        {
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2019-09-01",
            "name": "Require automatic OS image patching on Virtual Machine Scale Sets",
            "properties": {
                "displayName": "Require automatic OS image patching on Virtual Machine Scale Sets",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/465f0161-0087-490a-9ad9-ad6217f4f43a",
                "description": "This policy enforces enabling automatic OS image patching on Virtual Machine Scale Sets to always keep Virtual Machines secure by safely applying latest security patches every month.",
                "metadata": {
                    "version": "1.0.0",
                    "category": "Compute"
                },
                "parameters": {}
            }
        },
        {
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2019-09-01",
            "name": "Require encryption on Data Lake Store accounts",
            "properties": {
                "displayName": "Require encryption on Data Lake Store accounts",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/a7ff3161-0087-490a-9ad9-ad6217f4f43a",
                "description": "This policy ensures encryption is enabled on all Data Lake Store accounts",
                "metadata": {
                    "version": "1.0.0",
                    "category": "Data Lake"
                },
                "parameters": {}
            }
        },
        {
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2019-09-01",
            "name": "Management ports of virtual machines should be protected with just-in-time network access control",
            "properties": {
                "displayName": "Management ports of virtual machines should be protected with just-in-time network access control",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/b0f33259-77d7-4c9e-aac6-3aabcfae693c",
                "description": "Possible network Just In Time (JIT) access will be monitored by Azure Security Center as recommendations",
                "metadata": {
                    "version": "3.0.0",
                    "category": "Security Center"
                },
                "parameters": {
                    "effect": {
                        "type": "string",
                        "metadata": {
                            "description": "Enable or disable the execution of the policy",
                            "displayName": "Effect"
                        },
                        "allowedValues": [
                            "AuditIfNotExists",
                            "Disabled"
                        ],
                        "defaultValue": "AuditIfNotExists"
                    }
                }
            }
        },
        {
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2019-09-01",
            "name": "[Deprecated]: MFA should be enabled for accounts with write permissions on your subscription",
            "properties": {
                "displayName": "[Deprecated]: MFA should be enabled for accounts with write permissions on your subscription",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/9297c21d-2ed6-4474-b48f-163f75654ce3",
                "description": "This policy definition is no longer the recommended way to achieve its intent. Instead of continuing to use this policy, we recommend you assign this replacement policy with policy ID 931e118d-50a1-4457-a5e4-78550e086c52. Learn more about policy definition deprecation at aka.ms/policydefdeprecation",
                "metadata": {
                    "version": "3.0.1-deprecated",
                    "category": "Security Center"
                },
                "parameters": {
                    "effect": {
                        "type": "string",
                        "metadata": {
                            "description": "Enable or disable the execution of the policy",
                            "displayName": "Effect"
                        },
                        "allowedValues": [
                            "AuditIfNotExists",
                            "Disabled"
                          ],
                          "defaultValue": "AuditIfNotExists"
                    }
                }
            }
        },
        {
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2019-09-01",
            "name": "[Deprecated]: MFA should be enabled on accounts with owner permissions on your subscription",
            "properties": {
                "displayName": "[Deprecated]: MFA should be enabled on accounts with owner permissions on your subscription",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/aa633080-8b72-40c4-a2d7-d00c03e80bed",
                "description": "This policy definition is no longer the recommended way to achieve its intent. Instead of continuing to use this policy, we recommend you assign this replacement policy with policy ID e3e008c3-56b9-4133-8fd7-d3347377402a. Learn more about policy definition deprecation at aka.ms/policydefdeprecation",
                "metadata": {
                    "version": "3.0.0-deprecated",
                    "category": "Security Center"
                },
                "parameters": {
                    "effect": {
                        "type": "string",
                        "metadata": {
                            "description": "Enable or disable the execution of the policy",
                            "displayName": "Effect"
                        },
                        "allowedValues": [
                            "AuditIfNotExists",
                            "Disabled"
                          ],
                          "defaultValue": "AuditIfNotExists"
                    }
                }
            }
        },
        {
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2019-09-01",
            "name": "[Deprecated]: RDP access from the Internet should be blocked",
            "properties": {
                "displayName": "[Deprecated]: RDP access from the Internet should be blocked",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/e372f825-a257-4fb8-9175-797a8a8627d6",
                "description": "This policy is deprecated. This policy audits any network security rule that allows RDP access from Internet",
                "metadata": {
                    "version": "2.0.0-deprecated",
                    "category": "Network"
                },
                "parameters": {
                    "effect": {
                        "value": "[parameters('effect)]"
                    }
                }
            }
        },
        {
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2019-09-01",
            "name": "Require automatic OS image patching on Virtual Machine Scale Sets",
            "properties": {
                "displayName": "Require automatic OS image patching on Virtual Machine Scale Sets",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/465f0161-0087-490a-9ad9-ad6217f4f43a",
                "description": "This policy enforces enabling automatic OS image patching on Virtual Machine Scale Sets to always keep Virtual Machines secure by safely applying latest security patches every month.",
                "metadata": {
                    "version": "1.0.0",
                    "category": "Compute"
                },
                "parameters": {
                }
            }
        },
        {
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2019-09-01",
            "name": "Secure transfer to storage accounts should be enabled",
            "properties": {
                "displayName": "Secure transfer to storage accounts should be enabled",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/404c3081-a854-4457-ae30-26a93ef643f9",
                "description": "Audit requirement of Secure transfer in your storage account. Secure transfer is an option that forces your storage account to accept requests only from secure connections (HTTPS). Use of HTTPS ensures authentication between the server and the service and protects data in transit from network layer attacks such as man-in-the-middle, eavesdropping, and session-hijacking",
                "metadata": {
                    "version": "2.0.0",
                    "category": "Storage"
                },
                "parameters": {
                    "effect": {
                        "type": "string",
                        "metadata": {
                            "description": "The effect determines what happens when the policy rule is evaluated to match",
                            "displayName": "Effect"
                        },
                        "allowedValues": [
                            "Audit",
                            "Deny",
                            "Disabled"
                          ],
                          "defaultValue": "Audit"
                    }
                }
            }
        },
        {
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2019-09-01",
            "name": "SSH access from the Internet should be blocked",
            "properties": {
                "displayName": "SSH access from the Internet should be blocked",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/2c89a2e5-7285-40fe-afe0-ae8654b92fab",
                "description": "This policy is deprecated. This policy audits any network security rule that allows SSH access from Internet",
                "metadata": {
                    "version": "2.0.0-deprecated",
                    "category": "Network",
                    "deprecated": true
                },
                "parameters": {
                    "effect": {
                        "type": "string",
                        "metadata": {
                            "description": "Enable or disable the execution of the policy",
                            "displayName": "Effect"
                          },
                          "allowedValues": [
                            "Audit",
                            "Disabled"
                          ],
                          "defaultValue": "Audit"
                    }
                }
            }
        },
        {
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2019-09-01",
            "name": "Storage accounts should have infrastructure encryption",
            "properties": {
                "displayName": "Storage accounts should have infrastructure encryption",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/4733ea7b-a883-42fe-8cac-97454c2a9e4a",
                "description": "Enable infrastructure encryption for higher level of assurance that the data is secure. When infrastructure encryption is enabled, data in a storage account is encrypted twice.",
                "metadata": {
                    "version": "1.0.0",
                    "category": "Storage"
                },
                "parameters": {
                    "effect": {
                        "type": "string",
                        "metadata": {
                            "description": "Enable or disable the execution of the audit policy",
                            "displayName": "Effect"
                        },
                        "allowedValues": [
                            "Audit",
                            "Deny",
                            "Disabled"
                        ],
                        "defaultValue": "Audit"
                    }
                }
            }
        },
        {
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2019-09-01",
            "name": "Storage Accounts should use a virtual network service endpoint",
            "properties": {
                "displayName": "Storage Accounts should use a virtual network service endpoint",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/60d21c4f-21a3-4d94-85f4-b924e6aeeda4",
                "description": "This policy audits any Storage Account not configured to use a virtual network service endpoint.",
                "metadata": {
                    "version": "1.0.0",
                    "category": "Network"
                },
                "parameters": {
                    "effect": {
                        "type": "string",
                        "metadata": {
                            "description": "Enable or disable the execution of the policy",
                            "displayName": "Effect"
                        },
                        "allowedValues": [
                            "Audit",
                            "Disabled"
                          ],
                          "defaultValue": "Audit"
                    }
                }
            }
        },
        {
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2019-09-01",
            "name": "Subnets should be associated with a Network Security Group",
            "properties": {
                "displayName": "Subnets should be associated with a Network Security Group",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/e71308d3-144b-4262-b144-efdc3cc90517",
                "description": "Protect your subnet from potential threats by restricting access to it with a Network Security Group (NSG). NSGs contain a list of Access Control List (ACL) rules that allow or deny network traffic to your subnet.",
                "metadata": {
                    "version": "3.0.0",
                    "category": "Security Center"
                },
                "parameters": {
                    "effect": {
                        "type": "string",
                        "metadata": {
                            "description": "Enable or disable the execution of the policy",
                            "displayName": "Effect"
                        },
                        "allowedValues": [
                            "AuditIfNotExists",
                            "Disabled"
                        ],
                        "defaultValue": "AuditIfNotExists"
                    }
                }
            }
        },
        {
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2019-09-01",
            "name": "System updates should be installed on your machines",
            "properties": {
                "displayName": "System updates should be installed on your machines",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/86b3d65f-7626-441e-b690-81a8b71cff60",
                "description": "Missing security system updates on your servers will be monitored by Azure Security Center as recommendations",
                "metadata": {
                    "version": "4.0.0",
                    "category": "Security Center"
                },
                "parameters": {
                    "effect": {
                        "type": "string",
                        "metadata": {
                            "description": "Enable or disable the execution of the policy",
                            "displayName": "Effect"
                        },
                        "allowedValues": [
                            "AuditIfNotExists",
                            "Disabled"
                        ],
                        "defaultValue": "AuditIfNotExists"
                    }
                }
            }
        },
        {
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2019-09-01",
            "name": "Transparent Data Encryption on SQL databases should be enabled",
            "properties": {
                "displayName": "Transparent Data Encryption on SQL databases should be enabled",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/17k78e20-9358-41c9-923c-fb736d382a12",
                "description": "Transparent data encryption should be enabled to protect data-at-rest and meet compliance requirements",
                "metadata": {
                    "version": "2.0.0",
                    "category": "SQL"
                },
                "parameters": {
                    "effect": {
                        "type": "string",
                        "metadata": {
                            "description": "Enable or disable the execution of the policy",
                            "displayName": "Effect"
                        },
                        "allowedValues": [
                            "AuditIfNotExists",
                            "Disabled"
                        ],
                        "defaultValue": "AuditIfNotExists"
                    }
                }
            }
        },
        {
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2019-09-01",
            "name": "Web Application Firewall (WAF) should be enabled for Application Gateway",
            "properties": {
                "displayName": "Web Application Firewall (WAF) should be enabled for Application Gateway",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/564feb30-bf6a-4854-b4bb-0d2d2d1e6c66",
                "description": "Deploy Azure Web Application Firewall (WAF) in front of public facing web applications for additional inspection of incoming traffic. Web Application Firewall (WAF) provides centralized protection of your web applications from common exploits and vulnerabilities such as SQL injections, Cross-Site Scripting, local and remote file executions. You can also restrict access to your web applications by countries, IP address ranges, and other http(s) parameters via custom rules.",
                "metadata": {
                    "version": "2.0.0",
                    "category": "Network"
                },
                "parameters": {
                    "effect": {
                        "type": "string",
                        "metadata": {
                            "description": "Enable or disable the execution of the policy",
                            "displayName": "Effect"
                        },
                        "allowedValues": [
                            "Audit",
                            "Deny",
                            "Disabled"
                          ],
                          "defaultValue": "Audit"
                    }
                }
            }
        },
        {
            "type": "Microsoft.Authorization/policyAssignments",
            "apiVersion": "2019-09-01",
            "name": "Azure Web Application Firewall should be enabled for Azure Front Door entry-points",
            "properties": {
                "displayName": "Azure Web Application Firewall should be enabled for Azure Front Door entry-points",
                "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/055aa869-bc98-4af8-bafc-23f1ab6ffe2c",
                "description": "Deploy Azure Web Application Firewall (WAF) in front of public facing web applications for additional inspection of incoming traffic. Web Application Firewall (WAF) provides centralized protection of your web applications from common exploits and vulnerabilities such as SQL injections, Cross-Site Scripting, local and remote file executions. You can also restrict access to your web applications by countries, IP address ranges, and other http(s) parameters via custom rules.",
                "metadata": {
                    "version": "1.0.2",
                    "category": "Network"
                },
                "parameters": {
                    "effect": {
                        "type": "string",
                        "metadata": {
                            "description": "Enable or disable the execution of the policy",
                            "displayName": "Effect"
                        },
                        "allowedValues": [
                            "Audit",
                            "Deny",
                            "Disabled"
                        ],
                        "defaultValue": "Audit"
                    }
                }
            }
        }
    ]
}